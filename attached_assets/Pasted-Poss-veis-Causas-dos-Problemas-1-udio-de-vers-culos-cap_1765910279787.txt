Poss√≠veis Causas dos Problemas
1. √Åudio de vers√≠culos / cap√≠tulos / livros n√£o reproduz
Causas comuns:
Arquivos de √°udio n√£o est√£o no Storage do Supabase ou n√£o foram feitas as permiss√µes corretas de leitura.
Pol√≠ticas de seguran√ßa (RLS ‚Äì Row Level Security) no bucket do Storage impedem o acesso p√∫blico.
URLs mal formadas ou caminhos incorretos ao buscar os arquivos.
CORS ou bloqueio do navegador ao tentar carregar o √°udio (especialmente se o Storage n√£o estiver com dom√≠nio configurado).
‚úÖ Verifique:

ts
// Exemplo de como acessar um √°udio no Supabase Storage
const { data } = supabase.storage
  .from('bible-audio')
  .getPublicUrl('livros/joao/cap1/vers1.mp3');

// O bucket 'bible-audio' precisa ter RLS desativado ou regras que permitam acesso an√¥nimo

Solu√ß√£o:

No Supabase Dashboard > Storage > bucket > Policies, adicione uma pol√≠tica como:

sql
CREATE POLICY "Permitir leitura p√∫blica de √°udios"
ON storage.objects FOR SELECT
USING (bucket_id = 'bible-audio');

Ou use um token de acesso tempor√°rio se quiser manter RLS ativo.
2. Podcast n√£o funciona
Possibilidades:
O feed RSS do podcast n√£o est√° sendo gerado corretamente (falta rota /rss.xml ou /podcast/feed).
Os arquivos de √°udio do podcast n√£o s√£o acess√≠veis publicamente (mesmo problema do item 1).
Metadados ausentes (t√≠tulo, descri√ß√£o, data, link) impedem o reconhecimento como podcast v√°lido.
‚úÖ Verifique se:

Seu backend (ex: Supabase Edge Functions, Next.js API, etc.) gera um XML v√°lido conforme especifica√ß√£o RSS 2.0 com Apple Podcasts tags.
3. Sistema de assinatura (premium) n√£o funciona
Causas comuns:
Integra√ß√£o com Stripe n√£o configurada em produ√ß√£o (ex: usando chaves de teste localmente, mas sem configurar as chaves reais no ambiente de produ√ß√£o).
Webhooks do Stripe n√£o verificados ou endpoint /api/webhooks/stripe n√£o est√° recebendo eventos (ex: assinatura criada, pagamento falhou).
Tabela de usu√°rios no Supabase n√£o est√° atualizando o campo is_premium com base no status do Stripe.
‚úÖ Verifique:

Vari√°veis de ambiente em produ√ß√£o:

env

NEXT_PUBLIC_STRIPE_PUBLIC_KEY=pk_live_...
STRIPE_SECRET_KEY=sk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...


Se o webhook est√° registrado no Stripe Dashboard com a URL correta (ex: https://bibliafs.com.br/api/webhooks/stripe).
Se h√° log de erro no backend ao receber eventos do Stripe (stripe.webhooks.constructEvent).
4. Doa√ß√µes n√£o funcionam
Possibilidades:
Mesmo problema da assinatura: chaves do Stripe incorretas.
Checkout de doa√ß√£o n√£o est√° vinculado a um produto/price v√°lido no Stripe.
Falta de rota de confirma√ß√£o ou atualiza√ß√£o no banco quando a doa√ß√£o √© conclu√≠da.
Bot√£o de doa√ß√£o n√£o dispara a chamada correta (ex: stripe.redirectToCheckout com sessionId inv√°lido).
‚úÖ Teste:

Simule uma doa√ß√£o com modo de teste do Stripe em produ√ß√£o (use cart√£o de teste 4242...).
Veja se o evento checkout.session.completed √© disparado e processado.
üîß Recomenda√ß√µes Gerais para Produ√ß√£o com Supabase
Ative logs no Supabase (SQL logs, function logs) para ver falhas reais.
Use supabase logs ou integre com ferramentas como Sentry ou Logtail.
Valide todas as pol√≠ticas RLS ‚Äî em produ√ß√£o, elas bloqueiam tudo por padr√£o.
Teste funcionalidades cr√≠ticas com usu√°rios an√¥nimos e logados ‚Äî RLS pode se comportar diferente.
Verifique CORS e Content Security Policy (CSP) no seu frontend ‚Äî pode bloquear reprodu√ß√£o de √°udio ou chamadas √† API.
üí° Dica R√°pida: Teste de √Åudio Offline
Se o app √© offline-first, os √°udios n√£o podem depender de internet. Nesse caso, voc√™ n√£o pode usar o Supabase Storage para √°udio offline ‚Äî precisa baixar e armazenar localmente (ex: com IndexedDB ou Cache API).
‚ö†Ô∏è O Supabase Storage n√£o funciona offline ‚Äî ele √© um servi√ßo HTTP.

Se voc√™ promete "offline total", os √°udios deveriam ser pr√©-embalados no app (PWA) ou baix√°veis para armazenamento local via Service Worker + Cache.